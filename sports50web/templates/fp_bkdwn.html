{% load static %}

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Field Position Breakdown</title>

{{ script | safe }}

</head>

<style>
table#fp_stats {
  width: 100%;
  border: 1px solid black;
}

table#fp_stats th {
  padding: 15px;
  font-size: 24px;
}

table#fp_stats td {
  padding: 10px;
  text-align: center;
}

.stat {
  font-size: 18px;
}


.slidecontainer {
  width: 100%; /* Width of the outside container */
}

/* The slider itself */
.slider {
  -webkit-appearance: none;  /* Override default CSS styles */
  appearance: none;
  width: 100%; /* Full-width */
  height: 25px; /* Specified height */
  background: #d3d3d3; /* Grey background */
  outline: none; /* Remove outline */
  opacity: 0.7; /* Set transparency (for mouse-over effects on hover) */
  -webkit-transition: .2s; /* 0.2 seconds transition on hover */
  transition: opacity .2s;
  direction: rtl
}

/* Mouse-over effects */
.slider:hover {
  opacity: 1; /* Fully shown on mouse-over */
}

/* The slider handle (use -webkit- (Chrome, Opera, Safari, Edge) and -moz- (Firefox) to override default look) */ 
.slider::-webkit-slider-thumb {
  -webkit-appearance: none; /* Override default look */
  appearance: none;
  width: 25px; /* Set a specific slider handle width */
  height: 25px; /* Slider handle height */
  background: #4CAF50; /* Green background */
  cursor: pointer; /* Cursor on hover */
}

.slider::-moz-range-thumb {
  width: 25px; /* Set a specific slider handle width */
  height: 25px; /* Slider handle height */
  background: #4CAF50; /* Green background */
  cursor: pointer; /* Cursor on hover */
}

.yard_line_header {
  text-align: center;
  font-size: 44 px;

}

</style>


<body>
  <script>
    var field = JSON.parse('{{field | safe}}');
  </script>


<div style="position: fixed; background:#00FF7F; bottom: 20px; left: 20px; border: 3px solid #000000; padding: 3px;">
  <small style="color:Black; font-size:20px;">Use these options to toggle between statistics</small>  
  <br>
    <div class="myCheckboxText">
      <input type="checkbox" class="myCheckbox" value="2010" checked> 2010 
      <input type="checkbox" class="myCheckbox" value="2011" checked> 2011
      <input type="checkbox" class="myCheckbox" value="2012" checked> 2012 
      <input type="checkbox" class="myCheckbox" value="2013" checked> 2013
      <input type="checkbox" class="myCheckbox" value="2014" checked> 2014
      <input type="checkbox" class="myCheckbox" value="2015" checked> 2015
      <input type="checkbox" class="myCheckbox" value="2016" checked> 2016
      <input type="checkbox" class="myCheckbox" value="2017" checked> 2017
    </div>

</div> 


<div id="svg1" class="svgs">
  <script type="text/javascript">
      var svg = d3.select("#svg1").append("svg").attr("height","600").attr("width","1200").attr("id","first_svg");

  var div = d3.select("body").append("div")
      .attr("class", "tooltip").attr("id","first_svg_tooltip")      
      .style("opacity", 0).style("font", "24px sans-serif");   

    var images = [{"image": "{% static 'football_field_reshaped2.png' %}", "x": "100", "y": "-270", "width": "1000", "height": "1100"}]
    var imgs = svg.selectAll("image").data(images);
        imgs.enter()
        .append("svg:image")
        .attr("xlink:href", function(d){ return d.image})
        .attr("x", function(d){ return d.x})
        .attr("y", function(d){ return d.y})
        .attr("width", function(d){ return d.width})
        .attr("height", function(d){ return d.height});

  var field_data = 1002
  svg.append("line").attr("x1",field_data).attr("x2",field_data).attr("y1",26).attr("y2",463).style("stroke-width", 4).style("stroke", "blue")
  </script>
</div>

<script type="text/javascript">
  function years_total(current_yl,years,sym,label){
    var total = 0;
    for (var i=0; i<years.length; i++) {
      total += current_yl[years[i]][sym][label];
    }
    return total;
  }

  function slider(){

    var num = document.getElementById("myRange").value

    var svg = d3.select("#first_svg");
    var field_data = 1002 - (8*num);
    svg.selectAll("line").remove();
    svg.append("line").attr("x1",field_data).attr("x2",field_data).attr("y1",26).attr("y2",463).style("stroke-width", 4).style("stroke", "blue")


    document.getElementById('yard_line').innerHTML=num; 
    var yl_stats = field[num];    

    var years = [];
    d3.selectAll(".myCheckbox").each(function(d){
    cb = d3.select(this);
    if(cb.property("checked")){
      years.push(cb.property("value"));
      }
    });
  // yards
    var yards = [
      {id: "dl_yards", sym: 'dl'},
      {id: "dm_yards", sym: 'dm'},
      {id: "dr_yards", sym: 'dr'},
      {id: "sl_yards", sym: 'sl'},
      {id: "sm_yards", sym: 'sm'},
      {id: "sr_yards", sym: 'sr'}
      ];
    for (var i=0; i<yards.length; i++) {
        try {
        document.getElementById(yards[i].id).innerHTML = years_total(yl_stats,years,yards[i].sym,'yards__sum')
      } catch {
        document.getElementById(yards[i].id).innerHTML = ''
      }
    }     


    // completion percentage
    var comp_percentage = [
      {id: "dl_comp_perc", sym: 'dl'},
      {id: "dm_comp_perc", sym: 'dm'},
      {id: "dr_comp_perc", sym: 'dr'},
      {id: "sl_comp_perc", sym: 'sl'},
      {id: "sm_comp_perc", sym: 'sm'},
      {id: "sr_comp_perc", sym: 'sr'}
      ];
    for (var i=0; i<comp_percentage.length; i++) {
        try {
        document.getElementById(comp_percentage[i].id).innerHTML = ((years_total(yl_stats,years,comp_percentage[i].sym,'complete__sum') / (years_total(yl_stats,years,comp_percentage[i].sym,'complete__sum')+years_total(yl_stats,years,comp_percentage[i].sym,'incomplete__sum')))*100).toFixed(0)
      } catch {
        document.getElementById(comp_percentage[i].id).innerHTML = ''
      }
    }

    var comps = [
      {id: "dl_comps", sym: 'dl'},
      {id: "dm_comps", sym: 'dm'},
      {id: "dr_comps", sym: 'dr'},
      {id: "sl_comps", sym: 'sl'},
      {id: "sm_comps", sym: 'sm'},
      {id: "sr_comps", sym: 'sr'}
      ];
    for (var i=0; i<comps.length; i++) {
      try {
      document.getElementById(comps[i].id).innerHTML = years_total(yl_stats,years,comps[i].sym,'complete__sum').toString() + '/' + (years_total(yl_stats,years,comps[i].sym,'complete__sum')+years_total(yl_stats,years,comps[i].sym,'complete__sum')).toString()
      } catch {
        document.getElementById(comps[i].id).innerHTML = ''
      }      
    }        

    // touchdowns
    var td = [
      {id: "dl_td", sym: 'dl'},
      {id: "dm_td", sym: 'dm'},
      {id: "dr_td", sym: 'dr'},
      {id: "sl_td", sym: 'sl'},
      {id: "sm_td", sym: 'sm'},
      {id: "sr_td", sym: 'sr'}
      ];
    for (var i=0; i<td.length; i++) {
      try {
      document.getElementById(td[i].id).innerHTML = years_total(yl_stats,years,td[i].sym,'touchdown__sum')
      } catch {
        document.getElementById(td[i].id).innerHTML = ''
      }      
    }     

    // interceptions
    var int = [
      {id: "dl_int", sym: 'dl'},
      {id: "dm_int", sym: 'dm'},
      {id: "dr_int", sym: 'dr'},
      {id: "sl_int", sym: 'sl'},
      {id: "sm_int", sym: 'sm'},
      {id: "sr_int", sym: 'sr'}
      ];
    for (var i=0; i<int.length; i++) {
      try {
      document.getElementById(int[i].id).innerHTML = years_total(yl_stats,years,int[i].sym,'interception__sum')
      } catch {
        document.getElementById(int[i].id).innerHTML = ''
      }      
    }

    // pick sixes
    var pick_six = [
      {id: "dl_p6", sym: 'dl'},
      {id: "dm_p6", sym: 'dm'},
      {id: "dr_p6", sym: 'dr'},
      {id: "sl_p6", sym: 'sl'},
      {id: "sm_p6", sym: 'sm'},
      {id: "sr_p6", sym: 'sr'}
      ];
    for (var i=0; i<pick_six.length; i++) {
      try {
      document.getElementById(pick_six[i].id).innerHTML = years_total(yl_stats,years,pick_six[i].sym,'pick_six__sum')
      } catch {
        document.getElementById(pick_six[i].id).innerHTML = ''
      }
    }   
                                     

    // penalties
    var pen = [
      {id: "dl_pen", sym: 'dl'},
      {id: "dm_pen", sym: 'dm'},
      {id: "dr_pen", sym: 'dr'},
      {id: "sl_pen", sym: 'sl'},
      {id: "sm_pen", sym: 'sm'},
      {id: "sr_pen", sym: 'sr'}
      ];
    for (var i=0; i<pen.length; i++) {
      try {
      document.getElementById(pen[i].id).innerHTML = years_total(yl_stats,years,pen[i].sym,'penalty__sum')
      } catch {
        document.getElementById(pen[i].id).innerHTML = ''
      }      
    } 

    var dif = [
      {id: "dl_dif", sym: 'dl'},
      {id: "dm_dif", sym: 'dm'},
      {id: "dr_dif", sym: 'dr'},
      {id: "sl_dif", sym: 'sl'},
      {id: "sm_dif", sym: 'sm'},
      {id: "sr_dif", sym: 'sr'}
      ];
    for (var i=0; i<dif.length; i++) {
      try {
      document.getElementById(dif[i].id).innerHTML = years_total(yl_stats,years,dif[i].sym,'diff__avg').toFixed(2)
      } catch {
        document.getElementById(dif[i].id).innerHTML = ''
      }      
    }     

}
</script>


<input type="text" id="textInput" value="">
<div class="slidecontainer">
  <input type="range" min="1" max="99" value="50" class="slider" id="myRange" onchange="slider()">
</div>

<div class="yard_line_header">
<p class="yard_line_header">Passing Statistics for plays started <strong><span id="yard_line"></span></strong> yards from the endzone.</p>
</div>

<table id="fp_stats">
  <tr>
    <th></th>
    <th>Deep Left</th>
    <th>Deep Middle</th> 
    <th>Deep Right</th>
  </tr>
  <tr>
    <th>Total Yards</th>
    <td><span id="dl_yards", class="stat"></span></td>
    <td><span id="dm_yards", class="stat"></span></td> 
    <td><span id="dr_yards", class="stat"></span></td>
  </tr>  
  <tr>
    <th>Completion %</th>
    <td><span id="dl_comp_perc", class="stat"></span></td>
    <td><span id="dm_comp_perc", class="stat"></span></td> 
    <td><span id="dr_comp_perc", class="stat"></span></td>
  </tr>
  <tr>
    <th></th>
    <td><span id="dl_comps", class="stat"></span></td>
    <td><span id="dm_comps", class="stat"></span></td> 
    <td><span id="dr_comps", class="stat"></span></td>
  </tr>    
  <tr>
    <th>Touchdowns</th>
    <td><span id="dl_td", class="stat"></span></td>
    <td><span id="dm_td", class="stat"></span></td> 
    <td><span id="dr_td", class="stat"></span></td>
  </tr>
  <tr>
    <th>Interceptions</th>
    <td><span id="dl_int", class="stat"></span></td>
    <td><span id="dm_int", class="stat"></span></td> 
    <td><span id="dr_int", class="stat"></span></td>
  </tr>
  <tr>
    <th>Pick Sixes</th>
    <td><span id="dl_p6", class="stat"></span></td>
    <td><span id="dm_p6", class="stat"></span></td> 
    <td><span id="dr_p6", class="stat"></span></td>
  </tr> 
  <tr>
    <th>Penalties</th>
    <td><span id="dl_pen", class="stat"></span></td>
    <td><span id="dm_pen", class="stat"></span></td> 
    <td><span id="dr_pen", class="stat"></span></td>
  </tr>   
  <tr>
    <th><a href="https://www.sports-reference.com/blog/2012/03/features-expected-points/">EPD</a></th>
    <td><span id="dl_dif", class="stat"></span></td>
    <td><span id="dm_dif", class="stat"></span></td> 
    <td><span id="dr_dif", class="stat"></span></td>
  </tr>           
  <tr>
    <th style="border-top: 1px solid black"></th>
    <th style="border-top: 1px solid black">Short Left</th>
    <th style="border-top: 1px solid black">Short Middle</th> 
    <th style="border-top: 1px solid black">Short Right</th>
  </tr>  
  <tr>
    <th>Total Yards</th>
    <td><span id="sl_yards", class="stat"></span></td>
    <td><span id="sm_yards", class="stat"></span></td> 
    <td><span id="sr_yards", class="stat"></span></td>
  </tr>    
  <tr>
    <th>Completion %</th>
    <td><span id="sl_comp_perc", class="stat"></span></td>
    <td><span id="sm_comp_perc", class="stat"></span></td> 
    <td><span id="sr_comp_perc", class="stat"></span></td>
  </tr>  
  <tr>
    <th></th>
    <td><span id="sl_comps", class="stat"></span></td>
    <td><span id="sm_comps", class="stat"></span></td> 
    <td><span id="sr_comps", class="stat"></span></td>
  </tr>    
  <tr>
    <th>Touchdowns</th>
    <td><span id="sl_td", class="stat"></span></td>
    <td><span id="sm_td", class="stat"></span></td> 
    <td><span id="sr_td", class="stat"></span></td>
  </tr>  
  <tr>
    <th>Interceptions</th>
    <td><span id="sl_int", class="stat"></span></td>
    <td><span id="sm_int", class="stat"></span></td> 
    <td><span id="sr_int", class="stat"></span></td>
  </tr>
  <tr>
    <th>Pick Sixes</th>
    <td><span id="sl_p6", class="stat"></span></td>
    <td><span id="sm_p6", class="stat"></span></td> 
    <td><span id="sr_p6", class="stat"></span></td>
  </tr> 
  <tr>
    <th>Penalties</th>
    <td><span id="sl_pen", class="stat"></span></td>
    <td><span id="sm_pen", class="stat"></span></td> 
    <td><span id="sr_pen", class="stat"></span></td>
  </tr> 
  <tr>
    <th><a href="https://www.sports-reference.com/blog/2012/03/features-expected-points/">EPD</a></th>
    <td><span id="sl_dif", class="stat"></span></td>
    <td><span id="sm_dif", class="stat"></span></td> 
    <td><span id="sr_dif", class="stat"></span></td>
  </tr>         
</table>

<script>
  slider(document.getElementById("myRange").value)
</script>
<script type="text/javascript">
  d3.selectAll(".myCheckbox").on("change",slider);
slider();  
</script> 

</body>
</html>
